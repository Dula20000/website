<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ASE 370C: Feedback Control Systems Spring 2026 Homework 2</title>

<!-- External libraries included ONCE -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
  body {
    margin: 20px auto;
    max-width: 1000px;
    font-family: Arial, sans-serif;
    background: white;
    color: black;
  }
  hr {
    margin: 50px 0;
    border: none;
    border-top: 2px solid #444;
  }

  .hw-container {
    margin: 0 auto;
    max-width: 1100px;
    text-align: left;
  }

  :root {
    color-scheme: light dark;
    font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .page {
    max-width: 960px;
    margin: 0 auto;
    padding: 32px 24px 64px;
  }

  h1 {
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 12px;
  }

  h2 {
    font-size: 1.4rem;
    font-weight: 600;
    color: #1f2937;
    margin-top: 0;
  }

  p.description {
    font-size: 1rem;
    line-height: 1.5;
    margin-bottom: 24px;
    color: #4b5563;
  }

  .demo-card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 18px 40px rgba(15, 23, 42, 0.1);
    padding: 28px 32px 36px;
    margin-bottom: 40px;
  }

  .exercise {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.14), rgba(45, 212, 191, 0.14));
    border: 1px solid rgba(16, 185, 129, 0.25);
    border-radius: 16px;
    padding: 22px 26px;
    margin-bottom: 28px;
  }

  .exercise h2 {
    margin: 0 0 12px;
    font-size: 1.2rem;
    color: #065f46;
  }

  .exercise p {
    margin: 0 0 12px;
    color: #065f46;
    line-height: 1.7;
  }

  .equations {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.08), rgba(14, 165, 233, 0.08));
    border: 1px solid rgba(79, 70, 229, 0.15);
    border-radius: 12px;
    padding: 16px 18px;
    margin: 16px 0 24px;
    font-size: 0.95rem;
    color: #1f2937;
    text-align: center;
  }

  .plot-container {
    width: 100%;
    height: 380px;
    margin-bottom: 32px;
  }

  .footnote {
    margin-top: 28px;
    font-size: 0.85rem;
    color: #1f2937; font-weight: 600;
  }

  @media (max-width: 600px) {
    .demo-card {
      padding: 24px 20px 28px;
    }
    .plot-container {
      height: 320px;
    }
  }
</style>
<script>try { Plotly.defaults = { template: "plotly_white" }; } catch (e) {}</script>
</head>
<body>
<h1 style="text-align:center; margin: 24px 0;">ASE 370C: Feedback Control Systems Spring 2026 Homework 2</h1>
<div class="hw-container">

<div class="page">

  <p class="description">
    <span style="color: #999;">© [2026] [Ufuk Topcu, Adam Thorpe, Mustafa Karabag, Vivian Chen, Filippos Fotiadis, Su Ann Low]. All rights reserved. All course material is intended exclusively for use by students enrolled in this course. Redistribution, posting on public websites, sharing on file-hosting services, or inclusion in other instructional materials is strictly prohibited without prior written permission of the authors. Unauthorized distribution may violate copyright law.</span>
    <br><br>
    Total points: 110 (= 40 + 20 + 20 + 30).
    <br><br>
    Submit your work to Gradescope as a single PDF. Solutions must be typed, NOT handwritten.
    <br><br>
    Your answers must show your reasoning and work. Include all calculations, figures, drawings, code, etc. that support your answers in the PDF.
  </p>

  <hr>

  <!-- Problem 1 (matrix exponential) -->
  <div class="demo-card">
    <div class="exercise">
      <h2>Problem 1 <span style="font-weight: normal; font-size: 0.9rem; color: #1f2937; font-weight: 600;">(40 pts)</span></h2>
      <p>Consider the linear system \(\dot{x} = Ax\), with</p>
      <div class="equations">
        \[
        A = \begin{bmatrix} 0 & 1 & 0 \\ -1 & 1 & 1 \\ 1 & 0 & -1 \end{bmatrix}.
        \]
      </div>
      <p><strong>a) Matrix exponential via the power series</strong></p>
      <p>Recall that the matrix exponential is defined by the infinite series</p>
      <div class="equations">
        \[
        e^{At} = I + At + \frac{(At)^2}{2!} + \frac{(At)^3}{3!} + \cdots
        \]
      </div>
      <p style="margin-left: 20px;">1. Compute the powers \(A^2\) and \(A^3\).</p>
      <p style="margin-left: 20px;">2. Show that \(A^3 = 0\).</p>
      <p style="margin-left: 20px;">3. Use the series definition above to compute \(e^{At}\) explicitly.</p>
      <p><strong>b) Similarity to a nilpotent Jordan block</strong></p>
      <p>Let</p>
      <div class="equations">
        \[
        J = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{bmatrix}, \qquad
        T = \begin{bmatrix} 1 & 1 & 1 \\ 0 & 1 & 1 \\ 1 & 0 & 1 \end{bmatrix}, \qquad
        T^{-1} = \begin{bmatrix} 1 & -1 & 0 \\ 1 & 0 & -1 \\ -1 & 1 & 1 \end{bmatrix}.
        \]
      </div>
      <p>Show that \(A = TJT^{-1}\).</p>
      <p><strong>c) Matrix exponential via similarity transformation</strong></p>
      <p>From the lecture notes, recall that for any invertible matrix \(T\),</p>
      <div class="equations">
        \[
        e^{TJT^{-1}t} = T e^{Jt} T^{-1}.
        \]
      </div>
      <p style="margin-left: 20px;">1. Compute \(e^{Jt}\) explicitly.</p>
      <p style="margin-left: 20px;">2. Use the relation above to compute \(e^{At}\).</p>
      <p style="margin-left: 20px;">3. Verify that your result agrees with the expression obtained in part (a).</p>
      <p><strong>d) Stability of the system</strong></p>
      <p>Based on your expression for \(e^{At}\), determine whether the system \(\dot{x} = Ax\) is stable, marginally stable, or unstable.</p>
    </div>
  </div>

  <hr>

  <!-- Problem 2 (stability) -->
  <div class="demo-card">
    <div class="exercise">
      <h2>Problem 2 <span style="font-weight: normal; font-size: 0.9rem; color: #1f2937; font-weight: 600;">(20 pts)</span></h2>
      <p><strong>a)</strong> Consider the system \(\dot{x} = A_i x\) with</p>
      <div class="equations">
        \[
        A_1 = \begin{bmatrix} -1 & 1 \\ 0 & -1 \end{bmatrix}, \qquad
        A_2 = \begin{bmatrix} 1 & -1 \\ 1 & 1 \end{bmatrix}, \qquad
        A_3 = \begin{bmatrix} -1 & 1 \\ 0 & 0 \end{bmatrix}.
        \]
      </div>
      <p>For each \(A_i\), determine whether the system is stable, marginally stable, or unstable.</p>
      <p><strong>b)</strong> Consider the linear system \(\dot{x} = Ax\) where</p>
      <div class="equations">
        \[
        A = \begin{bmatrix} -2 & 1 & 0 \\ 0 & -1 & 1 \\ 0 & -1 & -1 \end{bmatrix}.
        \]
      </div>
      <p>Determine whether the system is stable, marginally stable, or unstable.</p>
    </div>
  </div>

  <hr>

  <!-- Problem 3 (phase portrait) -->
  <div class="demo-card">
    <div class="exercise">
      <h2>Problem 3 <span style="font-weight: normal; font-size: 0.9rem; color: #1f2937; font-weight: 600;">(20 pts)</span></h2>
      <p>Consider a second-order system \(\dot{x} = Ax\). If you hover on the plot, you will see arrows which show the vector field, i.e., \(Ax\) for given \(x \in \mathbb{R}^2\). Four trajectories of the system are also shown.</p>
    </div>

    <div id="plot2" class="plot-container"></div>

    <div id="vectorDisplay" style="text-align: center; padding: 12px 16px; background: linear-gradient(135deg, rgba(225, 29, 72, 0.08), rgba(244, 63, 94, 0.08)); border: 1px solid rgba(225, 29, 72, 0.2); border-radius: 10px; margin-bottom: 20px; font-family: 'Inter', sans-serif; font-size: 1rem; color: #be123c;">
      <em>Hover over the plot to see the vector field</em>
    </div>

    <div class="exercise">
      <p><strong>a)</strong> Identify the matrix \(A\).</p>
      <p><strong>b)</strong> Find the eigenvalues of \(A\) and determine whether the system is stable.</p>
      <p><strong>c)</strong> Can you explain the "shape" of the trajectories shown using the eigenvalues?</p>
    </div>
  </div>

  <hr>

  <!-- Problem 4 (eigenvalues and eigenvectors) -->
  <div class="demo-card">
    <div class="exercise">
      <h2>Problem 4 <span style="font-weight: normal; font-size: 0.9rem; color: #1f2937; font-weight: 600;">(30 pts)</span></h2>
      <p>Consider the linear system \(\dot{x} = Ax\), with</p>
      <div class="equations">
        \[
        A = \begin{bmatrix} -1 & 1 \\ 0 & 1 \end{bmatrix}.
        \]
      </div>
      <p><strong>a)</strong> Compute the eigenvalues of \(A\). Call them \(\lambda_1\) and \(\lambda_2\).</p>
      <p><strong>b)</strong> For each eigenvalue, compute a corresponding eigenvector. Call them \(v_1\) and \(v_2\), respectively.</p>
      <p><strong>c)</strong> Write the general solution \(x(t)\) in terms of the eigen-decomposition (i.e., as a linear combination of modal responses).</p>
      <p><strong>d)</strong> Express an arbitrary initial condition \(x(0) = x_0\) as a linear combination</p>
      <div class="equations">
        \[
        x_0 = c_1 v_1 + c_2 v_2
        \]
      </div>
      <p>of the eigenvectors. Then, express \(c_1\) and \(c_2\) in terms of the entries of \(x_0\).</p>
      <p><strong>e)</strong> Determine the set of all initial conditions \(x_0\) that produce solutions that converge to the origin as \(t \to \infty\).</p>
    </div>
  </div>

</div>

<script type="text/babel">// Problem 3 phase portrait with interactive vector field
(function(){
  // A = [2 4; -1 2], eigenvalues: 2 ± 2i (unstable spiral)
  const dt = 0.005;
  const tMax = 2;
  
  const traces = [];
  const colors = ['#1d4ed8', '#f97316', '#10b981', '#8b5cf6'];
  
  // 4 initial conditions close to origin
  const initialConditions = [
    [0.1, 0], [-0.1, 0], [0, 0.1], [0, -0.1]
  ];
  
  initialConditions.forEach((x0, idx) => {
    const x1 = [], x2 = [];
    let x = [...x0];
    
    for (let ti = 0; ti <= tMax; ti += dt) {
      x1.push(x[0]);
      x2.push(x[1]);
      // dx/dt = Ax where A = [2 4; -1 2]
      const dx0 = 2*x[0] + 4*x[1];
      const dx1 = -x[0] + 2*x[1];
      x[0] += dx0 * dt;
      x[1] += dx1 * dt;
      
      // Stop if trajectory goes way too far
      if (Math.abs(x[0]) > 10 || Math.abs(x[1]) > 10) break;
    }
    
    traces.push({
      x: x1,
      y: x2,
      type: 'scatter',
      mode: 'lines',
      line: { width: 2, color: colors[idx] },
      showlegend: false,
      hoverinfo: 'none'
    });
    
    // Add arrowhead pointing in direction of motion
    if (x1.length > 10) {
      const arrowIdx = Math.floor(x1.length * 0.5);
      const dx = x1[arrowIdx + 1] - x1[arrowIdx - 1];
      const dy = x2[arrowIdx + 1] - x2[arrowIdx - 1];
      const angle = Math.atan2(dy, dx) * 180 / Math.PI;
      
      traces.push({
        x: [x1[arrowIdx]],
        y: [x2[arrowIdx]],
        type: 'scatter',
        mode: 'markers',
        marker: { 
          size: 10, 
          color: colors[idx], 
          symbol: 'triangle-up',
          angle: 90 - angle
        },
        showlegend: false,
        hoverinfo: 'none'
      });
    }
  });
  
  const layout = {
    margin: { l: 60, r: 18, t: 28, b: 50 },
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(248,250,252,0.92)',
    font: { family: 'Inter, sans-serif', color: '#111827' },
    xaxis: { 
      title: 'x₁', 
      gridcolor: 'rgba(99,102,241,0.15)',
      zeroline: true,
      zerolinecolor: '#888',
      range: [-2, 2]
    },
    yaxis: { 
      title: 'x₂', 
      gridcolor: 'rgba(99,102,241,0.15)',
      zeroline: true,
      zerolinecolor: '#888',
      range: [-2, 2],
      scaleanchor: 'x',
      scaleratio: 1
    },
    annotations: [],
    hovermode: 'closest'
  };
  
  Plotly.newPlot('plot2', traces, layout, {
    displayModeBar: false,
    responsive: true
  });
  
  // Interactive vector display
  const plotDiv = document.getElementById('plot2');
  const vectorDisplay = document.getElementById('vectorDisplay');
  
  plotDiv.addEventListener('mousemove', function(evt) {
    const bb = plotDiv.getBoundingClientRect();
    const xaxis = plotDiv._fullLayout.xaxis;
    const yaxis = plotDiv._fullLayout.yaxis;
    
    // Get mouse position relative to plot
    const mouseX = evt.clientX - bb.left;
    const mouseY = evt.clientY - bb.top;
    
    // Convert pixel to data coordinates
    const x1 = xaxis.p2d(mouseX - plotDiv._fullLayout.margin.l);
    const x2 = yaxis.p2d(mouseY - plotDiv._fullLayout.margin.t);
    
    // Check if within plot area
    if (x1 >= -2 && x1 <= 2 && x2 >= -2 && x2 <= 2) {
      // Compute Ax where A = [2 4; -1 2]
      const ax = 2*x1 + 4*x2;
      const ay = -x1 + 2*x2;
      
      // Round for display
      const axRound = Math.round(ax * 100) / 100;
      const ayRound = Math.round(ay * 100) / 100;
      
      // Update display to show cursor position only
      vectorDisplay.innerHTML = `<strong>x</strong> = (${x1.toFixed(2)}, ${x2.toFixed(2)})`;
      
      // Update arrow annotation with label near tip
      const arrowScale = 0.25;
      const tipX = x1 + ax * arrowScale;
      const tipY = x2 + ay * arrowScale;
      
      const newAnnotations = [
        {
          x: tipX,
          y: tipY,
          ax: x1,
          ay: x2,
          xref: 'x',
          yref: 'y',
          axref: 'x',
          ayref: 'y',
          showarrow: true,
          arrowhead: 2,
          arrowsize: 1,
          arrowwidth: 2,
          arrowcolor: '#e11d48'
        },
        {
          x: tipX + 0.12,
          y: tipY + 0.12,
          xref: 'x',
          yref: 'y',
          text: `ẋ = (${axRound.toFixed(2)}, ${ayRound.toFixed(2)})`,
          showarrow: false,
          font: { size: 12, color: '#e11d48', family: 'Inter, sans-serif' },
          bgcolor: 'rgba(255,255,255,0.85)',
          borderpad: 3
        }
      ];
      
      Plotly.relayout('plot2', { annotations: newAnnotations });
    }
  });
  
  plotDiv.addEventListener('mouseleave', function() {
    vectorDisplay.innerHTML = '<em>Hover over the plot to see the vector field</em>';
    Plotly.relayout('plot2', { annotations: [] });
  });
})();</script>

</div>
</div>
</body>
</html>
